name: AI Selection Step

on:
    # schedule:
    #     - cron: "0 * * * *" # Every hour
    # issues:
    #     types: [closed]
    workflow_dispatch:

permissions:
    contents: read
    issues: write
    actions: write # Required to dispatch other workflows
    repository-projects: write

jobs:
    orchestrate:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Setup Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: "24"
                  cache: "npm"

            - name: Install dependencies
              run: npm ci || npm install

            - name: Run Task Selection
              env:
                  GH_TOKEN: ${{ secrets.GH_TOKEN }}
                  GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
              run: |
                  node tooling/ai-orchestration/selection.js
